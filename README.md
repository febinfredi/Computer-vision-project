# Semantic segmentation using traditional algorithms and Instance segmentation using RCNN

The aim of this project is to identify and differentiate between the different instances of a class present in an image, namely execute instance segmentation. For this project, we have worked to perform instance segmentation on stuffed toys present in an image and specifically on the leprechaun plushie. The motivation for this is the fact that we received the leprechaun toy in the class to detect and identify. We try to solve this challenge using a traditional method as well as a state-of-the-art method using deep convolutional neural networks. We begin our traditional approach by first implementing object detection. We detect keypoints in the image with ORB (Oriented FAST and Rotated BRIEF) and match them with a template image. Unfortunately, we find that the matching performed is not robust enough to create a scale and rotation invariant bounding box around the leprechaun. Instead, we calculate the median of the matched keypoints which is generally located on the face of the leprechaun. This gives us a good estimate of where the leprechaun is in the picture. Next, we try to make our algorithm scale invariant. To that end, we try to find a circle approximating the face of the leprechaun whose radius we can use as a reference to modify the size of the bounding box. We first apply Canny Filter on the Gaussian Filtered image followed by Hough Transform to detect the circles in the image. We then find the circle approximating the face by selecting the circle that is closest to the median. Scaling the size of our bounding box in proportion to the radius of this circle makes our algorithm scale invariant. Now, we focus on making our algorithm rotationally invariant as well. We apply PCA (Principal Component Analysis) within a box centered on the center of the circle we just found. Since the face of the leprechaun is symmetric, one of the eigenvectors found points towards the general upward direction of the leprechaun and we use this angle to orient our bounding box according to the tilt of the leprechaun. For segmentation, we apply HSV thresholding inside the bounding box we have obtained by estimating different HSV masks corresponding to the face, body and beard of the leprechaun in our template image. Our resulting rotation and scale invariant segmentation algorithm can successfully segment the leprechaun in different test images successfully. This implies that our algorithm is capable of semantic segmentation. However, we do not extend our algorithm to instance segmentation since we found that it is very difficult to generalize multiple members of a class without using neural networks. 

We also implement a state-of-the-art model for instance segmentation of our Leprechaun, namely Mask R-CNN. Here, Mask R-CNN uses Faster RCNN for object detection and FCN (Fully Convolutional Networks) for Segmentation. We annotate members of the class ‘Plushies’ consisting of the leprechaun and a few Pokemons. We utilized Transfer Learning and trained the last 2 layers of the Mask RCNN model with 120 self-annotated images for 200 epochs. The resulting model can successfully perform instance segmentation on images and real time videos.
